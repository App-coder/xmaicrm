<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"><head><script charset="utf-8" src="spring-ehcache_files/shares.js"></script>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Spring3.1整合EhCache注解实例 - 微骏技术网</title>
<meta name="keywords" content="spring,EhCache">
<meta name="description" content="Spring 3.1提供了对cache的支持，但到目前为止，支持的第三方cache只有Ehcache一种。在以前版本的spring中，也可以通过添加其它包实现对ehcache的注解化支持">
<link rel="shortcut icon" href="http://www.vijun.com/favicon.ico">
<link rel="stylesheet" type="text/css" href="spring-ehcache_files/all.css">
<link rel="stylesheet" type="text/css" href="spring-ehcache_files/thickbox.css">
<link rel="stylesheet" type="text/css" href="spring-ehcache_files/jquery.css">
<link rel="stylesheet" type="text/css" href="spring-ehcache_files/style.css">
<script type="text/javascript" src="spring-ehcache_files/jquery_002.js"></script>  
<script type="text/javascript" src="spring-ehcache_files/thickbox-compressed.js"></script> 
<script type="text/javascript" src="spring-ehcache_files/login.js"></script>
<script type="text/javascript" src="spring-ehcache_files/jquery.js"></script>
<script type="text/javascript" src="spring-ehcache_files/exp.js"></script>
<script type="text/javascript"> 
  //<![CDATA[
  $().ready(function() {
	  function formatItem(row,i,max) {
			return row[i-1];
		}
	  $("#search-keyword").autocomplete("http://www.vijun.com/searchjson.show", {
			width: 200,
			selectFirst: false,
			multiple: true,
			matchContains: true,
			dataType: 'json',
			parse: function(data) {
			       var rows = [];
			       for(var i=0; i<data.length; i++){
			        rows[rows.length] = { 
			          data:data, 
			          value:data[i], 
			          result:data[i]
			          }; 
			        }
			     return rows;
			       },
			formatItem: formatItem
		});
	  $("#search-keyword").result(function(event, data, formatted) {
		  $("#search-keyword").val(formatted);
		  window.location.href="http://www.vijun.com/luceneSearch.show?keyword="+formatted;
		});
  });
//]]>
</script>
</head>

<body><link type="text/css" rel="stylesheet" href="spring-ehcache_files/jiathis_counter.css"><script charset="utf-8" src="spring-ehcache_files/jiathis.js"></script><link type="text/css" rel="stylesheet" href="spring-ehcache_files/jiathis_share.css"><iframe style="position: fixed; display: none; opacity: 0;" frameborder="0"></iframe><div style="position: absolute; z-index: 1000000000; display: none; top: 50%; left: 50%; overflow: auto;" class="jiathis_style"></div><div style="position: absolute; z-index: 1000000000; display: none; overflow: auto;" class="jiathis_style"></div><iframe src="spring-ehcache_files/jiathis_utility.htm" style="display: none;" frameborder="0"></iframe>
<div id="main">
<div id="header">
    <div class="logo">
     <a href="http://www.vijun.com/"><img src="spring-ehcache_files/logo.png" alt="微骏技术网"></a>
    </div>
    <div class="head_left">
     <div class="search">
<table border="0" cellpadding="0" cellspacing="0">
      <tbody><tr>
        <td><input class="ac_input" autocomplete="off" name="keyword" id="search-keyword" x-webkit-speech="" type="text"></td>
         <td><select name="searchType" id="searchType" style="width:60px;overflow-x:hidden;font-family: Arial,sans-serif,宋体;">
					<option selected="selected" value="0">全文</option>
					<option value="1">模糊</option>
					</select></td>
        <td width="70"><input src="spring-ehcache_files/search.gif" name="Submit" onclick="return searchData('http://www.vijun.com','.show')" type="image"></td>
      </tr>
    </tbody></table></div>
    </div>
    <div class="navmenu">
      <ul>
        <li><a href="http://www.vijun.com/">首页</a></li>
<li><a href="http://www.vijun.com/news/index.html">软件新闻</a></li>
<li><a href="http://www.vijun.com/web/index.html">WEB技术</a></li>
<li><a href="http://www.vijun.com/front/index.html">前台技术</a></li>
<li><a href="http://www.vijun.com/database/index.html">数据库技术</a></li>
<li><a href="http://www.vijun.com/resource/index.html">资源下载</a></li>
      </ul>
    </div>
  </div><!--header--> <div class="main-index">
<div class="b-lrb3">
<div id="pt" class="cl">
<div class="z">
<a href="http://www.vijun.com/" class="nvhm" title="首页">首页</a> <em>›</em>
<a href="http://www.vijun.com/web/index.html">WEB技术</a> <em>›</em><a href="http://www.vijun.com/web/spring/index.html">spring框架</a> <em>›</em></div>
</div></div>
 
  <div class="main1 bg2">
<table class="b1" border="0" cellpadding="0" cellspacing="0" width="100%">
  <tbody><tr>
  <td class="b2" valign="top" width="100%">
<div class="newsLeftbg w712 bg1 item">
<h1>Spring3.1整合EhCache注解实例</h1>
<div class="info">
<span class="time" id="myTime">2012年02月17日 10:54:05</span>
<span class="web">来源:网络 </span>
<span class="author">作者:未知</span>
<span class="hit">点击:<script src="spring-ehcache_files/5f84f4d93588e8a60135893b16b20019.txt" type="text/javascript" language="javascript"></script>1781</span>
<span><a href="javascript:favorite('Spring3.1%E6%95%B4%E5%90%88EhCache%E6%B3%A8%E8%A7%A3%E5%AE%9E%E4%BE%8B','http://www.vijun.com','1','6','5f84f4d93588e8a60135893b16b20019','.show');">收藏</a></span>
</div>

<div class="line"></div> 
<div class="content">
Spring 3.1提供了对cache的支持，但到目前为止，支持的第三方cache只有Ehcache一种。在以前版本的spring中，也可以通过添加其它包实现对ehcache的注解化支持，但Spring 3.1提供了对cache的原生支持。<br><br>首先建好项目提供必要的包：<br><img src="spring-ehcache_files/0F821955A1076461E9DFBC57923258731B49AF2B.jpg" alt=""><br>包的用处不多说，然后写好一个ehcache.xml放到classpath下：<br><br>ehcache.xml<br><div><div id="highlighter_853058" class="syntaxhighlighter  html"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><caption>code</caption><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="html plain">&lt;?</code><code class="html keyword">xml</code> <code class="html color1">version</code><code class="html plain">=</code><code class="html string">"1.0"</code> <code class="html color1">encoding</code><code class="html plain">=</code><code class="html string">"UTF-8"</code><code class="html plain">?&gt;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="html plain">&lt;</code><code class="html keyword">ehcache</code><code class="html plain">&gt;</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">&lt;!--timeToIdleSeconds 当缓存闲置n秒后销毁 --&gt;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">&lt;!--timeToLiveSeconds 当缓存存活n秒后销毁 --&gt;</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">&lt;!-- 缓存配置</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">name:缓存名称。</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">maxElementsInMemory：缓存最大个数。</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">eternal:对象是否永久有效，一但设置了，timeout将不起作用。</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">timeToIdleSeconds：设置对象在失效前的允许闲置时间（单位：秒）。仅当eternal=false对象不是永久有效时使用，可选属性，默认值是0，也就是可闲置时间无穷大。</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">timeToLiveSeconds：设置对象在失效前允许存活时间（单位：秒）。最大时间介于创建时间和失效时间之间。仅当eternal=false对象不是永久有效时使用，默认是0.，也就是对象存活时间无穷大。</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">overflowToDisk：当内存中对象数量达到maxElementsInMemory时，Ehcache将会对象写到磁盘中。</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">diskSpoolBufferSizeMB：这个参数设置DiskStore（磁盘缓存）的缓存区大小。默认是30MB。每个Cache都应该有自己的一个缓冲区。</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">maxElementsOnDisk：硬盘最大缓存个数。</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">diskPersistent：是否缓存虚拟机重启期数据 Whether the disk store persists between restarts of the Virtual Machine. The default value is false.</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">diskExpiryThreadIntervalSeconds：磁盘失效线程运行时间间隔，默认是120秒。</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">memoryStoreEvictionPolicy：当达到maxElementsInMemory限制时，Ehcache将会根据指定的策略去清理内存。默认策略是LRU（最近最少使用）。你可以设置为FIFO（先进先出）或是LFU（较少使用）。</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">clearOnFlush：内存数量最大时是否清除。</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html comments">--&gt;</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">&lt;</code><code class="html keyword">diskStore</code> <code class="html color1">path</code><code class="html plain">=</code><code class="html string">"D:/tmpdir"</code><code class="html plain">/&gt;</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">&lt;</code><code class="html keyword">defaultCache</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html color1">maxElementsInMemory</code><code class="html plain">=</code><code class="html string">"500"</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html color1">eternal</code><code class="html plain">=</code><code class="html string">"false"</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html color1">timeToIdleSeconds</code><code class="html plain">=</code><code class="html string">"300"</code></div><div class="line number46 index45 alt1">&nbsp;</div><div class="line number47 index46 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html color1">timeToLiveSeconds</code><code class="html plain">=</code><code class="html string">"1200"</code></div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html color1">overflowToDisk</code><code class="html plain">=</code><code class="html string">"true"</code><code class="html plain">/&gt;</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">&lt;</code><code class="html keyword">cache</code> <code class="html color1">name</code><code class="html plain">=</code><code class="html string">"young"</code> <code class="html color1">maxElementsInMemory</code><code class="html plain">=</code><code class="html string">"150"</code> <code class="html color1">eternal</code><code class="html plain">=</code><code class="html string">"false"</code> <code class="html color1">timeToLiveSeconds</code><code class="html plain">=</code><code class="html string">"36000"</code> <code class="html color1">timeToIdleSeconds</code><code class="html plain">=</code><code class="html string">"3600"</code> <code class="html color1">overflowToDisk</code><code class="html plain">=</code><code class="html string">"true"</code><code class="html plain">/&gt;</code></div><div class="line number52 index51 alt1">&nbsp;</div><div class="line number53 index52 alt2"><code class="html plain">&lt;/</code><code class="html keyword">ehcache</code><code class="html plain">&gt;</code></div></div></td></tr></tbody></table></div></div>配置文件中进行了基本的配置，建立了一个叫“young”的cache。<br><br>然后在非整合spring的时候，测试一下cache是否使用成功：<br><br>NormalTest.java<br><div><div id="highlighter_928014" class="syntaxhighlighter  java"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><caption>code</caption><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">NormalTest {</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">public</code> <code class="java keyword">static</code> <code class="java keyword">void</code> <code class="java plain">main(String[] args) {</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="java plain">CacheManager manager = CacheManager.create();</code><code class="java comments">// 默认配置文件创建</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java plain">String[] names = manager.getCacheNames();</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="java keyword">for</code> <code class="java plain">(</code><code class="java keyword">int</code> <code class="java plain">i = </code><code class="java value">0</code><code class="java plain">; i &lt; names.length; i++) {</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="java plain">System.out.println(names[i]);</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="java plain">}</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java comments">//Cache cache = manager.getCache(names[0]);</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2">&nbsp;</div><div class="line number20 index19 alt1"><code class="java plain">Cache cache = </code><code class="java keyword">new</code> <code class="java plain">Cache(</code><code class="java string">"test"</code><code class="java plain">, </code><code class="java value">150</code><code class="java plain">, </code><code class="java keyword">true</code><code class="java plain">, </code><code class="java keyword">false</code><code class="java plain">, </code><code class="java value">5</code><code class="java plain">, </code><code class="java value">2</code><code class="java plain">);</code></div><div class="line number21 index20 alt2">&nbsp;</div><div class="line number22 index21 alt1"><code class="java plain">manager.addCache(cache);</code></div><div class="line number23 index22 alt2">&nbsp;</div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="java plain">cache.put(</code><code class="java keyword">new</code> <code class="java plain">Element(</code><code class="java string">"key1"</code><code class="java plain">,</code><code class="java string">"value1"</code><code class="java plain">));</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2">&nbsp;</div><div class="line number28 index27 alt1"><code class="java plain">Element element = cache.get(</code><code class="java string">"key1"</code><code class="java plain">);</code></div><div class="line number29 index28 alt2">&nbsp;</div><div class="line number30 index29 alt1"><code class="java plain">System.out.println(element.getValue());</code></div><div class="line number31 index30 alt2">&nbsp;</div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="java plain">String[] names1 = manager.getCacheNames();</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="java keyword">for</code> <code class="java plain">(</code><code class="java keyword">int</code> <code class="java plain">i = </code><code class="java value">0</code><code class="java plain">; i &lt; names1.length; i++) {</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="java plain">System.out.println(names1[i]);</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="java plain">}</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="java plain">}</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>运行一下，有输出存进去的值就OK啦。<br><br>下面开始整合Spring，建立Spring配置文件：<br><br>applicationContext.xml<br><div><div id="highlighter_977827" class="syntaxhighlighter  html"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><caption>code</caption><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div><div class="line number52 index51 alt1">52</div><div class="line number53 index52 alt2">53</div><div class="line number54 index53 alt1">54</div><div class="line number55 index54 alt2">55</div><div class="line number56 index55 alt1">56</div><div class="line number57 index56 alt2">57</div><div class="line number58 index57 alt1">58</div><div class="line number59 index58 alt2">59</div><div class="line number60 index59 alt1">60</div><div class="line number61 index60 alt2">61</div><div class="line number62 index61 alt1">62</div><div class="line number63 index62 alt2">63</div><div class="line number64 index63 alt1">64</div><div class="line number65 index64 alt2">65</div><div class="line number66 index65 alt1">66</div><div class="line number67 index66 alt2">67</div><div class="line number68 index67 alt1">68</div><div class="line number69 index68 alt2">69</div><div class="line number70 index69 alt1">70</div><div class="line number71 index70 alt2">71</div><div class="line number72 index71 alt1">72</div><div class="line number73 index72 alt2">73</div><div class="line number74 index73 alt1">74</div><div class="line number75 index74 alt2">75</div><div class="line number76 index75 alt1">76</div><div class="line number77 index76 alt2">77</div><div class="line number78 index77 alt1">78</div><div class="line number79 index78 alt2">79</div><div class="line number80 index79 alt1">80</div><div class="line number81 index80 alt2">81</div><div class="line number82 index81 alt1">82</div><div class="line number83 index82 alt2">83</div><div class="line number84 index83 alt1">84</div><div class="line number85 index84 alt2">85</div><div class="line number86 index85 alt1">86</div><div class="line number87 index86 alt2">87</div><div class="line number88 index87 alt1">88</div><div class="line number89 index88 alt2">89</div><div class="line number90 index89 alt1">90</div><div class="line number91 index90 alt2">91</div><div class="line number92 index91 alt1">92</div><div class="line number93 index92 alt2">93</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="html plain">&lt;?</code><code class="html keyword">xml</code> <code class="html color1">version</code><code class="html plain">=</code><code class="html string">"1.0"</code> <code class="html color1">encoding</code><code class="html plain">=</code><code class="html string">"UTF-8"</code><code class="html plain">?&gt;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="html plain">&lt;</code><code class="html keyword">beans</code> <code class="html color1">xmlns</code><code class="html plain">=</code><code class="html string">"<a href="http://www.springframework.org/schema/beans">http://www.springframework.org/schema/beans</a>"</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="html color1">xmlns:xsi</code><code class="html plain">=</code><code class="html string">"<a href="http://www.w3.org/2001/XMLSchema-instance">http://www.w3.org/2001/XMLSchema-instance</a>"</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="html color1">xmlns:tx</code><code class="html plain">=</code><code class="html string">"<a href="http://www.springframework.org/schema/tx">http://www.springframework.org/schema/tx</a>"</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="html color1">xmlns:aop</code><code class="html plain">=</code><code class="html string">"<a href="http://www.springframework.org/schema/aop">http://www.springframework.org/schema/aop</a>"</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="html color1">xmlns:context</code><code class="html plain">=</code><code class="html string">"<a href="http://www.springframework.org/schema/context">http://www.springframework.org/schema/context</a>"</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="html color1">xmlns:util</code><code class="html plain">=</code><code class="html string">"<a href="http://www.springframework.org/schema/util">http://www.springframework.org/schema/util</a>"</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="html color1">xmlns:p</code><code class="html plain">=</code><code class="html string">"<a href="http://www.springframework.org/schema/p">http://www.springframework.org/schema/p</a>"</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="html color1">xmlns:cache</code><code class="html plain">=</code><code class="html string">"<a href="http://www.springframework.org/schema/cache">http://www.springframework.org/schema/cache</a>"</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="html plain">xsi:schemaLocation="<a href="http://www.springframework.org/schema/beans">http://www.springframework.org/schema/beans</a></code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">http://www.springframework.org/schema/beans/spring-beans-3.0.xsd</a></code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/tx">http://www.springframework.org/schema/tx</a></code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/tx/spring-tx-3.0.xsd">http://www.springframework.org/schema/tx/spring-tx-3.0.xsd</a></code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/context">http://www.springframework.org/schema/context</a></code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/context/spring-context-3.0.xsd">http://www.springframework.org/schema/context/spring-context-3.0.xsd</a></code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/util">http://www.springframework.org/schema/util</a> </code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/util/spring-util-3.0.xsd">http://www.springframework.org/schema/util/spring-util-3.0.xsd</a></code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/cache">http://www.springframework.org/schema/cache</a> </code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="html plain"><a href="http://www.springframework.org/schema/cache/spring-cache.xsd">http://www.springframework.org/schema/cache/spring-cache.xsd</a>"&gt;</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2">&nbsp;</div><div class="line number40 index39 alt1"><code class="html comments">&lt;!-- 隐式地向 Spring 容器注册 </code></div><div class="line number41 index40 alt2">&nbsp;</div><div class="line number42 index41 alt1"><code class="html comments">AutowiredAnnotationBeanPostProcessor、</code></div><div class="line number43 index42 alt2">&nbsp;</div><div class="line number44 index43 alt1"><code class="html comments">CommonAnnotationBeanPostProcessor、</code></div><div class="line number45 index44 alt2">&nbsp;</div><div class="line number46 index45 alt1"><code class="html comments">PersistenceAnnotationBeanPostProcessor 以及</code></div><div class="line number47 index46 alt2">&nbsp;</div><div class="line number48 index47 alt1"><code class="html comments">equiredAnnotationBeanPostProcessor 这 4 个 BeanPostProcessor。</code></div><div class="line number49 index48 alt2">&nbsp;</div><div class="line number50 index49 alt1"><code class="html comments">在配置文件中使用 context 命名空间之前，</code></div><div class="line number51 index50 alt2">&nbsp;</div><div class="line number52 index51 alt1"><code class="html comments">必须在 &lt;beans&gt; 元素中声明 context 命名空间。 --&gt;</code></div><div class="line number53 index52 alt2">&nbsp;</div><div class="line number54 index53 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html plain">&lt;</code><code class="html keyword">context:annotation-config</code><code class="html plain">/&gt;</code></div><div class="line number55 index54 alt2">&nbsp;</div><div class="line number56 index55 alt1"><code class="html comments">&lt;!-- &lt;context:component-scan/&gt; 配置项不但启用了对类包进行扫描</code></div><div class="line number57 index56 alt2">&nbsp;</div><div class="line number58 index57 alt1"><code class="html comments">以实施注释驱动 Bean 定义的功能，</code></div><div class="line number59 index58 alt2">&nbsp;</div><div class="line number60 index59 alt1"><code class="html comments">同时还启用了注释驱动自动注入的功能</code></div><div class="line number61 index60 alt2">&nbsp;</div><div class="line number62 index61 alt1"><code class="html comments">（即还隐式地在内部注册了 AutowiredAnnotationBeanPostProcessor </code></div><div class="line number63 index62 alt2">&nbsp;</div><div class="line number64 index63 alt1"><code class="html comments">和 CommonAnnotationBeanPostProcessor） --&gt;</code></div><div class="line number65 index64 alt2">&nbsp;</div><div class="line number66 index65 alt1"><code class="html plain">&lt;</code><code class="html keyword">context:component-scan</code> <code class="html color1">base-package</code><code class="html plain">=</code><code class="html string">"young"</code> <code class="html plain">/&gt;</code></div><div class="line number67 index66 alt2">&nbsp;</div><div class="line number68 index67 alt1"><code class="html comments">&lt;!-- 缓存注解驱动 --&gt;</code></div><div class="line number69 index68 alt2">&nbsp;</div><div class="line number70 index69 alt1"><code class="html plain">&lt;</code><code class="html keyword">cache:annotation-driven</code> <code class="html plain">/&gt;</code></div><div class="line number71 index70 alt2">&nbsp;</div><div class="line number72 index71 alt1"><code class="html comments">&lt;!-- </code></div><div class="line number73 index72 alt2">&nbsp;</div><div class="line number74 index73 alt1"><code class="html comments">&lt;cache:annotation-driven cache-manager="cacheManager" proxy-target-class="false" mode="proxy"/&gt;--&gt;</code></div><div class="line number75 index74 alt2">&nbsp;</div><div class="line number76 index75 alt1">&nbsp;</div><div class="line number77 index76 alt2"><code class="html comments">&lt;!-- cacheManager工厂类 --&gt;</code></div><div class="line number78 index77 alt1">&nbsp;</div><div class="line number79 index78 alt2"><code class="html plain">&lt;</code><code class="html keyword">bean</code> <code class="html color1">id</code><code class="html plain">=</code><code class="html string">"cacheManagerFactory"</code> <code class="html color1">class</code><code class="html plain">=</code><code class="html string">"org.springframework.cache.ehcache.EhCacheManagerFactoryBean"</code></div><div class="line number80 index79 alt1">&nbsp;</div><div class="line number81 index80 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html color1">p:configLocation</code><code class="html plain">=</code><code class="html string">"classpath:ehcache.xml"</code></div><div class="line number82 index81 alt1">&nbsp;</div><div class="line number83 index82 alt2"><code class="html spaces">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</code><code class="html color1">p:shared</code><code class="html plain">=</code><code class="html string">"false"</code> <code class="html plain">/&gt;</code></div><div class="line number84 index83 alt1">&nbsp;</div><div class="line number85 index84 alt2">&nbsp;</div><div class="line number86 index85 alt1"><code class="html comments">&lt;!-- 声明cacheManager --&gt;</code></div><div class="line number87 index86 alt2">&nbsp;</div><div class="line number88 index87 alt1"><code class="html plain">&lt;</code><code class="html keyword">bean</code> <code class="html color1">id</code><code class="html plain">=</code><code class="html string">"cacheManager"</code> <code class="html color1">class</code><code class="html plain">=</code><code class="html string">"org.springframework.cache.ehcache.EhCacheCacheManager"</code></div><div class="line number89 index88 alt2">&nbsp;</div><div class="line number90 index89 alt1"><code class="html spaces">&nbsp;&nbsp;&nbsp;</code><code class="html color1">p:cacheManager-ref</code><code class="html plain">=</code><code class="html string">"cacheManagerFactory"</code><code class="html plain">/&gt;</code></div><div class="line number91 index90 alt2">&nbsp;</div><div class="line number92 index91 alt1">&nbsp;</div><div class="line number93 index92 alt2"><code class="html plain">&lt;/</code><code class="html keyword">beans</code><code class="html plain">&gt;</code></div></div></td></tr></tbody></table></div></div>建立一个有缓存使用的类：<br>CacheMethod.java<br><div><div id="highlighter_854408" class="syntaxhighlighter  java"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><caption>code</caption><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java keyword">package</code> <code class="java plain">young;</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.cache.annotation.Cacheable;</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="java keyword">import</code> <code class="java plain">org.springframework.stereotype.Component;</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="java color1">@Component</code></div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">CacheMethod {</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java color1">@Cacheable</code><code class="java plain">(</code><code class="java string">"young"</code><code class="java plain">)</code></div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java keyword">public</code> <code class="java plain">String getYoung(String str) {</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="java plain">System.out.println(</code><code class="java string">"method is running..."</code><code class="java plain">);</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="java keyword">return</code> <code class="java string">"1230-1230-1230-0123-0123"</code><code class="java plain">;</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="java plain">}</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>类中只有一个方法，返回固定值，并且会被缓存。<br>最后用Junit4对这个类进行测试：<br>SpringCacheTest.java<br><div><div id="highlighter_933475" class="syntaxhighlighter  java"><div class="toolbar"><span><a href="#" class="toolbar_item command_help help">?</a></span></div><table border="0" cellpadding="0" cellspacing="0"><caption>code</caption><tbody><tr><td class="gutter"><div class="line number1 index0 alt2">1</div><div class="line number2 index1 alt1">2</div><div class="line number3 index2 alt2">3</div><div class="line number4 index3 alt1">4</div><div class="line number5 index4 alt2">5</div><div class="line number6 index5 alt1">6</div><div class="line number7 index6 alt2">7</div><div class="line number8 index7 alt1">8</div><div class="line number9 index8 alt2">9</div><div class="line number10 index9 alt1">10</div><div class="line number11 index10 alt2">11</div><div class="line number12 index11 alt1">12</div><div class="line number13 index12 alt2">13</div><div class="line number14 index13 alt1">14</div><div class="line number15 index14 alt2">15</div><div class="line number16 index15 alt1">16</div><div class="line number17 index16 alt2">17</div><div class="line number18 index17 alt1">18</div><div class="line number19 index18 alt2">19</div><div class="line number20 index19 alt1">20</div><div class="line number21 index20 alt2">21</div><div class="line number22 index21 alt1">22</div><div class="line number23 index22 alt2">23</div><div class="line number24 index23 alt1">24</div><div class="line number25 index24 alt2">25</div><div class="line number26 index25 alt1">26</div><div class="line number27 index26 alt2">27</div><div class="line number28 index27 alt1">28</div><div class="line number29 index28 alt2">29</div><div class="line number30 index29 alt1">30</div><div class="line number31 index30 alt2">31</div><div class="line number32 index31 alt1">32</div><div class="line number33 index32 alt2">33</div><div class="line number34 index33 alt1">34</div><div class="line number35 index34 alt2">35</div><div class="line number36 index35 alt1">36</div><div class="line number37 index36 alt2">37</div><div class="line number38 index37 alt1">38</div><div class="line number39 index38 alt2">39</div><div class="line number40 index39 alt1">40</div><div class="line number41 index40 alt2">41</div><div class="line number42 index41 alt1">42</div><div class="line number43 index42 alt2">43</div><div class="line number44 index43 alt1">44</div><div class="line number45 index44 alt2">45</div><div class="line number46 index45 alt1">46</div><div class="line number47 index46 alt2">47</div><div class="line number48 index47 alt1">48</div><div class="line number49 index48 alt2">49</div><div class="line number50 index49 alt1">50</div><div class="line number51 index50 alt2">51</div></td><td class="code"><div class="container"><div class="line number1 index0 alt2"><code class="java color1">@RunWith</code><code class="java plain">(SpringJUnit4ClassRunner.</code><code class="java keyword">class</code><code class="java plain">)</code></div><div class="line number2 index1 alt1">&nbsp;</div><div class="line number3 index2 alt2"><code class="java color1">@ContextConfiguration</code><code class="java plain">(locations = { </code><code class="java string">"classpath:applicationContext.xml"</code> <code class="java plain">})</code></div><div class="line number4 index3 alt1">&nbsp;</div><div class="line number5 index4 alt2"><code class="java keyword">public</code> <code class="java keyword">class</code> <code class="java plain">SpringCacheTest {</code></div><div class="line number6 index5 alt1">&nbsp;</div><div class="line number7 index6 alt2"><code class="java color1">@Resource</code></div><div class="line number8 index7 alt1">&nbsp;</div><div class="line number9 index8 alt2"><code class="java plain">CacheManager manager;</code></div><div class="line number10 index9 alt1">&nbsp;</div><div class="line number11 index10 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number12 index11 alt1">&nbsp;</div><div class="line number13 index12 alt2"><code class="java color1">@Resource</code></div><div class="line number14 index13 alt1">&nbsp;</div><div class="line number15 index14 alt2"><code class="java plain">CacheMethod method;</code></div><div class="line number16 index15 alt1">&nbsp;</div><div class="line number17 index16 alt2"><code class="java spaces">&nbsp;</code>&nbsp;</div><div class="line number18 index17 alt1">&nbsp;</div><div class="line number19 index18 alt2"><code class="java color1">@Test</code></div><div class="line number20 index19 alt1">&nbsp;</div><div class="line number21 index20 alt2"><code class="java keyword">public</code> <code class="java keyword">void</code> <code class="java plain">testGetYoung() {</code></div><div class="line number22 index21 alt1">&nbsp;</div><div class="line number23 index22 alt2"><code class="java comments">// CacheMethod method = new CacheMethod();这样得到的实例不在Spring的管理之中，也无法Cache</code></div><div class="line number24 index23 alt1">&nbsp;</div><div class="line number25 index24 alt2"><code class="java plain">String s = method.getYoung(</code><code class="java string">"str"</code><code class="java plain">);</code></div><div class="line number26 index25 alt1">&nbsp;</div><div class="line number27 index26 alt2"><code class="java plain">System.out.println(s);</code></div><div class="line number28 index27 alt1">&nbsp;</div><div class="line number29 index28 alt2"><code class="java plain">String s1 = method.getYoung(</code><code class="java string">"str"</code><code class="java plain">);</code></div><div class="line number30 index29 alt1">&nbsp;</div><div class="line number31 index30 alt2"><code class="java plain">System.out.println(s1);</code></div><div class="line number32 index31 alt1">&nbsp;</div><div class="line number33 index32 alt2"><code class="java plain">String[] names = manager.getCacheNames();</code></div><div class="line number34 index33 alt1">&nbsp;</div><div class="line number35 index34 alt2"><code class="java keyword">for</code> <code class="java plain">(</code><code class="java keyword">int</code> <code class="java plain">i = </code><code class="java value">0</code><code class="java plain">; i &lt; names.length; i++) {</code><code class="java comments">// 输出所有缓存</code></div><div class="line number36 index35 alt1">&nbsp;</div><div class="line number37 index36 alt2"><code class="java plain">System.out.println(names[i]);</code></div><div class="line number38 index37 alt1">&nbsp;</div><div class="line number39 index38 alt2"><code class="java plain">}</code></div><div class="line number40 index39 alt1">&nbsp;</div><div class="line number41 index40 alt2"><code class="java plain">Cache young = manager.getCache(</code><code class="java string">"young"</code><code class="java plain">);</code><code class="java comments">// 得到cache</code></div><div class="line number42 index41 alt1">&nbsp;</div><div class="line number43 index42 alt2"><code class="java plain">System.out.println(</code><code class="java string">"Cache named 'young':"</code> <code class="java plain">+ young);</code></div><div class="line number44 index43 alt1">&nbsp;</div><div class="line number45 index44 alt2"><code class="java plain">assertEquals(</code><code class="java string">"str"</code><code class="java plain">, young.getKeys().get(</code><code class="java value">0</code><code class="java plain">));</code></div><div class="line number46 index45 alt1">&nbsp;</div><div class="line number47 index46 alt2"><code class="java plain">assertEquals(s, young.get(</code><code class="java string">"str"</code><code class="java plain">).getValue());</code></div><div class="line number48 index47 alt1">&nbsp;</div><div class="line number49 index48 alt2"><code class="java plain">}</code></div><div class="line number50 index49 alt1">&nbsp;</div><div class="line number51 index50 alt2"><code class="java plain">}</code></div></div></td></tr></tbody></table></div></div>到此应该就测试成功啦！~<br><br><br>最后说下我遇到的错误，最一开始在测试中这样写的：<br><br>CacheMethod method = new CacheMethod();<br><br>然后进行调用 ，发现返回值并没有进行缓存，再次调用时仍然会打印出getYoung（）中的日志。这是由于这种调用并不是在Spring的管理下进行的，所以Spring也就不能对其进行cache了。<br>
</div><!--content-->

<div class="page">
</div><!-- page end -->

 
<div class="line"></div> 
<!-- JiaThis Button BEGIN -->
<div id="ckepop" style="   margin-left:30px; margin-top:3px;">
	<a title="分享到新浪微博" class="jiathis_button_tsina"><span class="jiathis_txt jtico jtico_tsina"></span></a>
	<a title="分享到网易微博" class="jiathis_button_t163"><span class="jiathis_txt jtico jtico_t163"></span></a>
	<a title="分享到腾讯微博" class="jiathis_button_tqq"><span class="jiathis_txt jtico jtico_tqq"></span></a>
	<a title="分享到人人网" class="jiathis_button_renren"><span class="jiathis_txt jtico jtico_renren"></span></a>
	<a title="分享到开心网" class="jiathis_button_kaixin001"><span class="jiathis_txt jtico jtico_kaixin001"></span></a>
	<a title="分享到QQ空间" class="jiathis_button_qzone"><span class="jiathis_txt jtico jtico_qzone"></span></a>
	<a title="分享到豆瓣" class="jiathis_button_douban"><span class="jiathis_txt jtico jtico_douban"></span></a>
	<a href="http://www.jiathis.com/share/?uid=1525591" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
	<a class="jiathis_counter_style"><span title="累计分享0次" id="jiathis_counter_20" class="jiathis_button_expanded jiathis_counter jiathis_bubble_style">0</span></a>
</div>

<!-- JiaThis Button END -->
<div class="tag"> 
<a href="http://www.vijun.com/tag/spring/">spring</a> <a href="http://www.vijun.com/tag/ehcache/">ehcache</a> 
</div>
<div class="editor"></div>

</div><!--newsLeftbg-->

<div class="newsLeftbg w702 bg1 mt4 postComments">
<div class="commentsTitle"><a href="javascript:openCommentsUrl('http://www.vijun.com','.show','5f84f4d93588e8a60135893b16b20019')">已经有<span style="color:red"><script src="spring-ehcache_files/5f84f4d93588e8a60135893b16b20019_002.txt" type="text/javascript" language="javascript"></script>0</span>人发表该内容评论</a></div><div class="msg" id="commentsMsg">Ctrl+Enter发送评论</div>
<div class="fontMsg"><span id="commentsFontMsg">还可以输入500字符</span><span class="desc"><a class="postComments-trigger" href="javascript:;">插入表情</a> | <a href="javascript:javash_win('%E7%99%BB%E5%BD%95','http://www.vijun.com/member/login.show?keepThis=true&amp;TB_iframe=true&amp;height=280&amp;width=420');">登录留言</a> | <a href="javascript:qqInput();">在线输入汉字</a></span></div>
 
<div class="textInput"><input name="contentId" value="5f84f4d93588e8a60135893b16b20019" id="contentId" type="hidden"><textarea name="commentsText" id="commentsText"></textarea></div>
<div class="vercodes" id="showCode"> <span>验证码：</span><input id="verCode" name="verCode" type="text"><img src="spring-ehcache_files/vercode.jpeg" title="单击换图片" id="kaptchaImage" onclick="kaptchaVerCode('http://www.vijun.com/admin/vercode.show?')" height="30" width="100"><img class="submitComment" src="spring-ehcache_files/comments.gif" onclick="postForm('http://www.vijun.com','.show')"></div>
</div><!-- postComments end -->

  </td>
  <td valign="top">
  <div class="fr w264 b3 ">

 <div class="div3 mt4 w258">
  <div class="t4"><span class="fl pl10b">
 会员登录 </span></div>
 </div>
 <div class="b-lrb1 bg1 w258 h100">
 <div id="loginInfo">
<div style="text-align:center; line-height:25px">游客您好!请<a href="javascript:javash_win('%E5%BE%AE%E9%AA%8F%E7%BD%91%E4%BC%9A%E5%91%98%E7%99%BB%E5%BD%95','http://www.vijun.com/member/login.show?keepThis=true&amp;TB_iframe=true&amp;height=280&amp;width=420')">登录</a>或<a href="javascript:javash_win('%E6%B3%A8%E5%86%8C%E4%BC%9A%E5%91%98','http://www.vijun.com/member/register.show?keepThis=true&amp;TB_iframe=true&amp;height=400&amp;width=400');">注册</a></div>
<div>

<ul class="ulioc">
<li><a href="javascript:javash_win('%E5%BE%AE%E9%AA%8F%E7%BD%91%E4%BC%9A%E5%91%98%E7%99%BB%E5%BD%95','http://www.vijun.com/member/login.show?keepThis=true&amp;TB_iframe=true&amp;height=280&amp;width=420')"><img title="本站登录" src="spring-ehcache_files/vijun_ico.jpg"></a></li>
<li><a href="javascript:loginOauth('http://www.vijun.com/oauth/qq/login.show')"><img title="QQ登录" src="spring-ehcache_files/qq_ico.jpg"></a></li>
<li><a href="javascript:loginOauth('http://www.vijun.com/oauth/msn/login.show')"><img title="MSN登录" src="spring-ehcache_files/msn_ico.jpg"></a></li>
<li><a href="javascript:loginOauth('http://www.vijun.com/oauth/baidu/login.show')"><img title="百度登录" src="spring-ehcache_files/baidu_ico.jpg"></a></li>
</ul>
</div>

   </div>
 
 </div><!--right list-->
 

 <div class="b-lrb1 bg1 mt4 w258">
 <script type="text/javascript"><!--
google_ad_client = "ca-pub-4007800463741953";
/* 250x250, 创建于 09-12-3 */
google_ad_slot = "0999481006";
google_ad_width = 250;
google_ad_height = 250;
//-->
</script>
<script type="text/javascript" src="spring-ehcache_files/show_ads.js">
</script><ins style="display:inline-table;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:250px"><ins id="aswift_0_anchor" style="display:block;border:none;height:250px;margin:0;padding:0;position:relative;visibility:visible;width:250px"><iframe allowtransparency="true" hspace="0" marginwidth="0" marginheight="0" onload="var i=this.id,s=window.google_iframe_oncopy,H=s&amp;&amp;s.handlers,h=H&amp;&amp;H[i],w=this.contentWindow,d;try{d=w.document}catch(e){}if(h&amp;&amp;d&amp;&amp;(!d.body||!d.body.firstChild)){if(h.call){setTimeout(h,0)}else if(h.match){w.location.replace(h)}}" vspace="0" id="aswift_0" name="aswift_0" style="left:0;position:absolute;top:0;" frameborder="0" height="250" scrolling="no" width="250"></iframe></ins></ins>
 
 </div><!--right list-->
 
 <div class="div3 mt4 w258">
  <div class="t4"><span class="fl pl10b">
 推荐文章 </span></div>
 </div>
 <div class="b-lrb1 bg1 w258">
 <ul class="u3 ls">
<li><a href="http://www.vijun.com/web/spring/2012/05/5f84f4d9370c64cb013773c1c2f600de.html" title="Spring MVC 3.2异步新特性实例" target="_blank">Spring MVC 3.2异步新特性实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d9363e806b01364d0582b7002e.html" title="工具类获取Spring的ApplicationContext对象" target="_blank">工具类获取Spring的ApplicationContext对象</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d9363e806b01364cf94dbd002a.html" title="学Spring要了解bean实例化顺序" target="_blank">学Spring要了解bean实例化顺序</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d935e5b13f01362de76085013d.html" title="Spring配置log4j实例" target="_blank">Spring配置log4j实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93588e8a60135893b16b20019.html" title="Spring3.1整合EhCache注解实例" target="_blank">Spring3.1整合EhCache注解实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93588e8a60135892be1c80012.html" title="spring3.x中使用查询缓存实例" target="_blank">spring3.x中使用查询缓存实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93550710101355ae3c739004e.html" title="spring mvc整合freemarker VS servlet性能" target="_blank">spring mvc整合freemarker VS servlet性能</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/01/5f84f4d934f609600134fe636a450020.html" title="Spring框架获得DataSource对象" target="_blank">Spring框架获得DataSource对象</a></li>
</ul>
 </div><!--right list-->
  <div class="div3 mt4 w258">
  <div class="t4"><span class="fl pl10b">
 热门文章 </span></div>
 </div>
 <div class="b-lrb1 bg1 w258">
  <ul class="u3 ls">
<li><a href="http://www.vijun.com/web/spring/2012/05/5f84f4d9370c64cb013773c5959e00e1.html" title="Spring MVC 3.2实时更新技术" target="_blank">Spring MVC 3.2实时更新技术</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/05/5f84f4d9370c64cb013773c1c2f600de.html" title="Spring MVC 3.2异步新特性实例" target="_blank">Spring MVC 3.2异步新特性实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/05/5f84f4d9370c64cb013773be6f7700dc.html" title="Spring MVC 3.2异步支持" target="_blank">Spring MVC 3.2异步支持</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d9363e806b01364d0582b7002e.html" title="工具类获取Spring的ApplicationContext对象" target="_blank">工具类获取Spring的ApplicationContext对象</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d9363e806b01364cfe730f002c.html" title="Spring框架实现邮件发送实例" target="_blank">Spring框架实现邮件发送实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d9363e806b01364cf94dbd002a.html" title="学Spring要了解bean实例化顺序" target="_blank">学Spring要了解bean实例化顺序</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d935e5b13f01362de76085013d.html" title="Spring配置log4j实例" target="_blank">Spring配置log4j实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d9359388af013598b40810001c.html" title="Spring对外部属性文件指定的某个属性进行加密、解密" target="_blank">Spring对外部属性文件指定的某个属性进行加密、解密</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93588e8a60135893b16b20019.html" title="Spring3.1整合EhCache注解实例" target="_blank">Spring3.1整合EhCache注解实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93588e8a601358936063b0015.html" title="细说Spring事务传播行为@Transactional" target="_blank">细说Spring事务传播行为@Transactional</a></li>
</ul>
 </div><!--right list-->
   <div class="div3 mt4 w258">
  <div class="t4"><span class="fl pl10b">
 相关内容</span></div>
 </div>
 <div class="b-lrb1 bg1 w258">
  <ul class="u3 ls">
<li><a href="http://www.vijun.com/web/spring/2012/05/5f84f4d9370c64cb013773c5959e00e1.html" title="Spring MVC 3.2实时更新技术" target="_blank">Spring MVC 3.2实时更新技术</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/05/5f84f4d9370c64cb013773c1c2f600de.html" title="Spring MVC 3.2异步新特性实例" target="_blank">Spring MVC 3.2异步新特性实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/05/5f84f4d9370c64cb013773be6f7700dc.html" title="Spring MVC 3.2异步支持" target="_blank">Spring MVC 3.2异步支持</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d9363e806b01364cfe730f002c.html" title="Spring框架实现邮件发送实例" target="_blank">Spring框架实现邮件发送实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/03/5f84f4d9363e806b01364cf94dbd002a.html" title="学Spring要了解bean实例化顺序" target="_blank">学Spring要了解bean实例化顺序</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d9359388af013598b40810001c.html" title="Spring对外部属性文件指定的某个属性进行加密、解密" target="_blank">Spring对外部属性文件指定的某个属性进行加密、解密</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93588e8a601358936063b0015.html" title="细说Spring事务传播行为@Transactional" target="_blank">细说Spring事务传播行为@Transactional</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93588e8a60135892be1c80012.html" title="spring3.x中使用查询缓存实例" target="_blank">spring3.x中使用查询缓存实例</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d93588e8a6013589191f76000b.html" title="详解Spring2.5的配置文件" target="_blank">详解Spring2.5的配置文件</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d9357f068c013583d4cb260037.html" title="spring思想学习IOC概念" target="_blank">spring思想学习IOC概念</a></li>
<li><a href="http://www.vijun.com/web/spring/2012/02/5f84f4d9357f068c013583cf7cd20031.html" title="浅谈web.xml配置spring的几种方式" target="_blank">浅谈web.xml配置spring的几种方式</a></li>
</ul>
 </div><!--right list-->
</div><!--right div-->
  </td></tr></tbody></table>

 </div><!--main1-->
 </div><!--main-index-->
 <div class="footmenu">
 <span class="lianxi">
  <a href="http://www.vijun.com/about.html">关于我们</a> • <a href="http://www.vijun.com/ad.html">广告服务</a> • <a href="http://www.vijun.com/copyright.html">版权声明</a> • <a href="http://www.vijun.com/contact.html">联系我们 </a>  • <a href="http://www.vijun.com/help.html">捐助微骏 </a>  • <script src="spring-ehcache_files/stat.php" language="JavaScript" charset="utf8" type="text/javascript"></script><script src="spring-ehcache_files/cnzz_core.php" charset="utf-8" type="text/javascript"></script><a href="http://www.cnzz.com/stat/website.php?web_id=969008" target="_blank" title="站长统计">站长统计</a> • 沪ICP备12006519号-1 </span>
  
  <span class="beian ">
Powered by <a href="http://www.vijun.com/">微骏CMS</a> 
  </span>
</div></div><!--main-->
<script type="text/javascript" src="spring-ehcache_files/page.js"></script>
<script type="text/javascript">
var tb_pathToImage = "http://www.vijun.com/template/js/images/loadingAnimation.gif";
$('#faces').bind("click",function(){
	new Face('commentsText','http://www.vijun.com').show();
});
$("#myTime").html(converterTime(1329418445,'yyyy年MM月dd日 hh:mm:ss'));
jQuery(document).keypress(function(e){
	if(e.ctrlKey && e.which == 13 || e.which == 10) {
		postForm('http://www.vijun.com','.show');
   } else if (e.shiftKey && e.which==13 || e.which == 10) {
   		postForm('http://www.vijun.com','.show');
   }
});
loadLoginInfoData('http://www.vijun.com','.show');
function loadLoginInfoData(w,s) {
	$("#loginInfo").load(w+"/member/loginInfo"+s+'?'+Math.floor(Math.random() * 100),   function() {
		$(this).fadeIn("slow");
    }
    );}
</script>
<script type="text/javascript" src="spring-ehcache_files/shCore.js"></script>
	<script type="text/javascript" src="spring-ehcache_files/shAutoloader.js"></script>
	<link type="text/css" rel="stylesheet" href="spring-ehcache_files/shCoreDefault.css">
	<script>
		function path()
{
  var args = arguments,
      result = []
      ;
       
  for(var i = 0; i < args.length; i++)
      result.push(args[i].replace('@', 'http://www.vijun.com/template/js/syntaxHighlighter/scripts/'));
       
  return result
};

 
SyntaxHighlighter.autoloader.apply(null, path(
  'applescript            @shBrushJScript.js',
  'actionscript3 as3      @shBrushAS3.js',
  'bash shell             @shBrushBash.js',
  'coldfusion cf          @shBrushColdFusion.js',
  'cpp c                  @shBrushCpp.js',
  'c# c-sharp csharp      @shBrushCSharp.js',
  'css                    @shBrushCss.js',
  'delphi pascal          @shBrushDelphi.js',
  'diff patch pas         @shBrushDiff.js',
  'erl erlang             @shBrushErlang.js',
  'groovy                 @shBrushGroovy.js',
  'java                   @shBrushJava.js',
  'jfx javafx             @shBrushJavaFX.js',
  'js jscript javascript  @shBrushJScript.js',
  'perl pl                @shBrushPerl.js',
  'php                    @shBrushPhp.js',
  'text plain             @shBrushPlain.js',
  'py python              @shBrushPython.js',
  'ruby rails ror rb      @shBrushRuby.js',
  'sass scss              @shBrushSass.js',
  'scala                  @shBrushScala.js',
  'sql                    @shBrushSql.js',
  'vb vbnet               @shBrushVb.js',
  'xml xhtml xslt html    @shBrushXml.js'
));
SyntaxHighlighter.all();
loadComment();
$.expBlock.initExp({});
//使表情失效
$.expBlock.disableExp();
//使表情重新启动
$.expBlock.enableExp();
	</script>
<script type="text/javascript" src="spring-ehcache_files/loginAjax.js"></script>
<script type="text/javascript">var jiathis_config = {data_track_clickback:true};</script>
<script type="text/javascript" src="spring-ehcache_files/jia.js" charset="utf-8"></script><script type="text/javascript" src="spring-ehcache_files/plugin.js" charset="utf-8"></script><div style="position:absolute;width:0px;height:0px;"><object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000" id="JIATHISSWF" codebase="http://download.macromedia.com/pub/shockwave/cabs/flash/swflash.cab" height="0" width="0"><param name="allowScriptAccess" value="always"><param name="swLiveConnect" value="true"><param name="movie" value="http://www.jiathis.com/code/swf/m.swf"><param name="FlashVars" value="z=a"><embed name="JIATHISSWF" src="spring-ehcache_files/m.swf" flashvars="z=a" allowscriptaccess="always" swliveconnect="true" type="application/x-shockwave-flash" pluginspage="http://www.macromedia.com/go/getflashplayer" height="0" width="0"></object></div>

</body></html>